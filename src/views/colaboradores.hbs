<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <title>Gesti√≥n de Onboarding</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <div class="max-w-6xl mx-auto mt-10 mb-10 bg-white p-8 shadow rounded space-y-10">

    <header class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <h1 class="text-2xl font-bold">Gesti√≥n de Onboarding de Colaboradores</h1>
        <p class="text-sm text-gray-600 mt-1">
          Registro de colaboradores, estados de onboarding, calendario t√©cnico y alertas simuladas en una sola interfaz.
        </p>
      </div>
      <nav class="flex flex-wrap gap-2 text-sm">
        <a href="#registro" class="px-3 py-1 rounded border border-gray-300 hover:bg-gray-100">Registro</a>
        <a href="#dashboard" class="px-3 py-1 rounded border border-gray-300 hover:bg-gray-100">Dashboard</a>
        <a href="#calendario" class="px-3 py-1 rounded border border-gray-300 hover:bg-gray-100">Calendario T√©cnico</a>
        <a href="#alertas" class="px-3 py-1 rounded border border-gray-300 hover:bg-gray-100">Alertas</a>
      </nav>
    </header>

    <!-- 1. Registro de colaboradores -->
    <section id="registro" class="space-y-4">
      <h2 class="text-xl font-semibold">üßë‚Äçüíº Registro de colaboradores</h2>
      <p class="text-sm text-gray-600">
        Crea nuevos colaboradores indicando su fecha de ingreso y, opcionalmente, una fecha de onboarding t√©cnico asignada.
        Los estados de onboarding se inician como pendientes (‚ùå) y se pueden marcar como completados desde el dashboard.
      </p>

      <form action="/colaboradores/crear" method="POST" class="grid grid-cols-1 md:grid-cols-4 gap-4 bg-gray-50 p-4 rounded border">
        <div class="md:col-span-2">
          <label class="block text-sm font-medium mb-1">Nombre completo</label>
          <input name="nombre" class="w-full border p-2 rounded" placeholder="Nombre completo" required>
        </div>
        <div class="md:col-span-2">
          <label class="block text-sm font-medium mb-1">Correo electr√≥nico</label>
          <input name="correo" type="email" class="w-full border p-2 rounded" placeholder="correo@empresa.com" required>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Fecha de ingreso</label>
          <input name="fecha_ingreso" type="date" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Fecha onboarding t√©cnico (opcional)</label>
          <input name="fecha_onboarding_tecnico" type="date" class="w-full border p-2 rounded">
        </div>
        <div class="md:col-span-2 flex items-end">
          <button class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
            Guardar colaborador
          </button>
        </div>
      </form>
    </section>

    <!-- 2. Dashboard de colaboradores -->
    <section id="dashboard" class="space-y-4">
      <h2 class="text-xl font-semibold">üìä Dashboard de colaboradores</h2>
      <p class="text-sm text-gray-600">
        Visualiza el estado de los onboardings de bienvenida y t√©cnico, filtra por tipo y estado, y marca los procesos como completados.
        Tambi√©n puedes editar los datos de cada colaborador desde esta misma vista.
      </p>

      <!-- Filtros -->
      <form method="GET" action="/colaboradores" class="flex flex-wrap items-end gap-4 bg-gray-50 p-4 rounded border">
        <div>
          <label class="block text-sm font-medium mb-1">Tipo de onboarding</label>
          <select name="tipoOnboarding" class="border p-2 rounded">
            <option value="" {{#unless tieneFiltroTipo}}selected{{/unless}}>Todos</option>
            <option value="bienvenida" {{#if esBienvenida}}selected{{/if}}>Bienvenida general</option>
            <option value="tecnico" {{#if esTecnico}}selected{{/if}}>T√©cnico</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-1">Estado</label>
          <select name="estado" class="border p-2 rounded">
            <option value="" {{#unless tieneFiltroEstado}}selected{{/unless}}>Todos</option>
            <option value="completado" {{#if estadoCompletado}}selected{{/if}}>Completado</option>
            <option value="pendiente" {{#if estadoPendiente}}selected{{/if}}>Pendiente</option>
          </select>
        </div>

        <button class="bg-gray-800 text-white px-4 py-2 rounded hover:bg-black">
          Aplicar filtros
        </button>
      </form>

      <!-- Tabla de colaboradores -->
      <div class="overflow-x-auto border rounded">
        <table class="min-w-full border-collapse text-sm">
          <thead>
            <tr class="bg-gray-200">
              <th class="p-2 border">Nombre</th>
              <th class="p-2 border">Correo</th>
              <th class="p-2 border">Fecha ingreso</th>
              <th class="p-2 border">Onb. Bienvenida</th>
              <th class="p-2 border">Onb. T√©cnico</th>
              <th class="p-2 border">Fecha Onb. T√©cnico</th>
              <th class="p-2 border">Acciones</th>
            </tr>
          </thead>
          <tbody>
            {{#if colaboradores.length}}
              {{#each colaboradores}}
                <tr class="align-top">
                  <td class="p-2 border">{{nombre}}</td>
                  <td class="p-2 border">{{correo}}</td>
                  <td class="p-2 border">{{fecha_ingreso_display}}</td>
                  <td class="p-2 border text-center">
                    {{#if onboarding_bienvenida}}‚úÖ{{else}}‚ùå{{/if}}
                  </td>
                  <td class="p-2 border text-center">
                    {{#if onboarding_tecnico}}‚úÖ{{else}}‚ùå{{/if}}
                  </td>
                  <td class="p-2 border text-center">
                    {{#if fecha_onboarding_tecnico_display}}
                      {{fecha_onboarding_tecnico_display}}
                    {{else}}
                      -
                    {{/if}}
                  </td>
                  <td class="p-2 border">
                    <div class="flex flex-col gap-1">
                      {{!-- Marcar bienvenida completada --}}
                      {{#unless onboarding_bienvenida}}
                        <form method="POST" action="/colaboradores/{{id}}/marcar">
                          <input type="hidden" name="tipo" value="bienvenida">
                          <button class="w-full bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700">
                            Marcar bienvenida
                          </button>
                        </form>
                      {{/unless}}

                      {{!-- Marcar t√©cnico completado --}}
                      {{#unless onboarding_tecnico}}
                        <form method="POST" action="/colaboradores/{{id}}/marcar">
                          <input type="hidden" name="tipo" value="tecnico">
                          <button class="w-full bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700">
                            Marcar t√©cnico
                          </button>
                        </form>
                      {{/unless}}

                      {{!-- Edici√≥n inline --}}
                      <details class="mt-1">
                        <summary class="text-xs text-blue-700 cursor-pointer">Editar</summary>
                        <form method="POST" action="/colaboradores/{{id}}/actualizar" class="mt-2 space-y-1 text-xs bg-gray-50 p-2 rounded border">
                          <div>
                            <label class="block mb-1">Nombre</label>
                            <input name="nombre" class="w-full border p-1 rounded" value="{{nombre}}">
                          </div>
                          <div>
                            <label class="block mb-1">Correo</label>
                            <input name="correo" class="w-full border p-1 rounded" value="{{correo}}">
                          </div>
                          <div>
                            <label class="block mb-1">Fecha ingreso</label>
                            <input name="fecha_ingreso" type="date" class="w-full border p-1 rounded" value="{{fecha_ingreso_input}}">
                          </div>
                          <div>
                            <label class="block mb-1">Fecha onboarding t√©cnico</label>
                            <input name="fecha_onboarding_tecnico" type="date" class="w-full border p-1 rounded" value="{{fecha_onboarding_tecnico_input}}">
                          </div>
                          <div class="flex items-center gap-2 mt-1">
                            <label class="flex items-center gap-1">
                              <input type="checkbox" name="onboarding_bienvenida" {{#if onboarding_bienvenida}}checked{{/if}}>
                              <span>Bienvenida completada</span>
                            </label>
                          </div>
                          <div class="flex items-center gap-2">
                            <label class="flex items-center gap-1">
                              <input type="checkbox" name="onboarding_tecnico" {{#if onboarding_tecnico}}checked{{/if}}>
                              <span>T√©cnico completado</span>
                            </label>
                          </div>
                          <div class="pt-2">
                            <button class="w-full bg-indigo-600 text-white py-1 rounded hover:bg-indigo-700">
                              Guardar cambios
                            </button>
                          </div>
                        </form>
                      </details>
                    </div>
                  </td>
                </tr>
              {{/each}}
            {{else}}
              <tr>
                <td colspan="7" class="p-4 border text-center text-gray-500">
                  No hay colaboradores registrados todav√≠a.
                </td>
              </tr>
            {{/if}}
          </tbody>
        </table>
      </div>
    </section>

    <!-- 3. Calendario de Onboardings T√©cnicos -->
    <section id="calendario" class="space-y-4">
      <h2 class="text-xl font-semibold">üìÖ Calendario de Onboardings T√©cnicos</h2>
      <p class="text-sm text-gray-600">
        Gestiona el calendario anual de sesiones t√©cnicas como Journey to Cloud y otros cap√≠tulos. 
        Cada bloque puede representar entre 5 y 7 d√≠as de formaci√≥n.
      </p>

      <!-- Formulario para crear sesiones de onboarding t√©cnico -->
      <form action="/calendario/crear" method="POST" class="grid grid-cols-1 md:grid-cols-4 gap-4 bg-gray-50 p-4 rounded border">
        <div>
          <label class="block text-sm font-medium mb-1">Nombre de la sesi√≥n</label>
          <input name="nombre" class="w-full border p-2 rounded" placeholder="Journey to Cloud" required>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Cap√≠tulo (opcional)</label>
          <input name="capitulo" class="w-full border p-2 rounded" placeholder="Data, DevOps, etc.">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Responsable (nombre)</label>
          <input name="responsable_nombre" class="w-full border p-2 rounded" placeholder="Nombre del responsable">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Responsable (correo)</label>
          <input name="responsable_correo" type="email" class="w-full border p-2 rounded" placeholder="responsable@empresa.com">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Fecha inicio</label>
          <input name="fecha_inicio" type="date" class="w-full border p-2 rounded" required>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Fecha fin</label>
          <input name="fecha_fin" type="date" class="w-full border p-2 rounded" required>
        </div>
        <div class="md:col-span-4 flex justify-end">
          <button class="bg-emerald-600 text-white px-4 py-2 rounded hover:bg-emerald-700">
            Agregar sesi√≥n al calendario
          </button>
        </div>
      </form>

      <!-- Tabla de sesiones -->
      <div class="overflow-x-auto border rounded">
        <table class="min-w-full border-collapse text-sm">
          <thead>
            <tr class="bg-gray-200">
              <th class="p-2 border">Nombre</th>
              <th class="p-2 border">Cap√≠tulo</th>
              <th class="p-2 border">Responsable</th>
              <th class="p-2 border">Correo responsable</th>
              <th class="p-2 border">Fecha inicio</th>
              <th class="p-2 border">Fecha fin</th>
              <th class="p-2 border">Duraci√≥n (d√≠as)</th>
              <th class="p-2 border">Recordar</th>
            </tr>
          </thead>
          <tbody>
            {{#if sesiones.length}}
              {{#each sesiones}}
                <tr>
                  <td class="p-2 border">{{nombre}}</td>
                  <td class="p-2 border">{{capitulo}}</td>
                  <td class="p-2 border">{{responsable_nombre}}</td>
                  <td class="p-2 border">{{responsable_correo}}</td>
                  <td class="p-2 border">{{fecha_inicio_display}}</td>
                  <td class="p-2 border">{{fecha_fin_display}}</td>
                  <td class="p-2 border text-center">
                    {{duracion_dias}}
                  </td>
                  <td class="p-2 border text-center">
                    <form method="POST" action="/alertas/enviar-uno">
                      <input type="hidden" name="id" value="{{id}}">
                      <button class="bg-purple-500 text-white px-3 py-1 rounded text-xs hover:bg-purple-600">
                        Recordar
                      </button>
                    </form>
                  </td>
                </tr>
              {{/each}}
            {{else}}
              <tr>
                <td colspan="8" class="p-4 border text-center text-gray-500">
                  No hay sesiones t√©cnicas configuradas todav√≠a.
                </td>
              </tr>
            {{/if}}
          </tbody>
        </table>
      </div>
    </section>

    
</body>
</html>